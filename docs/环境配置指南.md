# Windows æœ¬åœ° AI ç¯å¢ƒé…ç½®æŒ‡å— (MVP å®æˆ˜ç‰ˆ)

> **æœ€åæ›´æ–°**: 2025-11-20
> **é€‚ç”¨åœºæ™¯**: Windows 10/11 + NVIDIA æ˜¾å¡ (RTX 30/40 ç³»åˆ—)
> **ç›®æ ‡**: è¿è¡Œ `faster-whisper` (ASR) å’Œ `Ollama` (LLM) å¹¶å¯ç”¨ GPU åŠ é€Ÿ

## 1. æ ¸å¿ƒç»„ä»¶ä¸ç‰ˆæœ¬æ¸…å•

| ç»„ä»¶ | ç‰ˆæœ¬ | è¯´æ˜ |
| :--- | :--- | :--- |
| **OS** | Windows 10/11 x64 | éœ€æ›´æ–°åˆ°è¾ƒæ–°ç‰ˆæœ¬ |
| **GPU é©±åŠ¨** | 576.88+ | ç¡®ä¿æ”¯æŒ CUDA 12.x |
| **CUDA Toolkit** | **12.6** | faster-whisper ç›®å‰çš„æœ€ä½³å…¼å®¹ç‰ˆæœ¬ |
| **cuDNN** | **9.x** (for CUDA 12) | æ·±åº¦å­¦ä¹ åŠ é€Ÿåº“ |
| **Python** | **3.10 - 3.12** | æ¨èä½¿ç”¨ `venv` è™šæ‹Ÿç¯å¢ƒ |
| **Ollama** | Latest | æœ¬åœ° LLM è¿è¡Œæ—¶ |

---

## 2. å®‰è£…æ­¥éª¤ (æŒ‰é¡ºåºæ‰§è¡Œ)

### 2.1 å®‰è£… CUDA Toolkit 12.6
1. **ä¸‹è½½**: [NVIDIA å®˜ç½‘ CUDA Archive](https://developer.nvidia.com/cuda-12-6-0-download-archive)
   - é€‰æ‹© `Windows` -> `x86_64` -> `11` -> `exe (local)`
2. **å®‰è£…**:
   - è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹© **è‡ªå®šä¹‰å®‰è£…**ã€‚
   - **å¿…é¡»å‹¾é€‰**: `CUDA Toolkit`, `Visual Studio Integration`ã€‚
   - **å–æ¶ˆå‹¾é€‰**: `Graphics Driver` (é˜²æ­¢è¦†ç›–ç°æœ‰é©±åŠ¨), `GeForce Experience`ã€‚
3. **éªŒè¯**:
   ```powershell
   nvcc --version  # åº”æ˜¾ç¤º V12.6.x
   ```

### 2.2 å®‰è£… cuDNN 9.x
1. **ä¸‹è½½**: [NVIDIA cuDNN å®˜ç½‘](https://developer.nvidia.com/cudnn) (éœ€ç™»å½•)
   - é€‰æ‹© `cuDNN 9.x for CUDA 12.x` -> `Windows (Local Installer)`ã€‚
2. **å®‰è£…**:
   - è¿è¡Œ `.exe` å®‰è£…ç¨‹åºã€‚
   - é»˜è®¤ä¼šå®‰è£…åˆ° `C:\Program Files\NVIDIA\CUDNN\v9.x`ã€‚
3. **å…³é”®æ­¥éª¤ï¼šå¤åˆ¶æ–‡ä»¶åˆ° CUDA ç›®å½•** (è§£å†³ `Could not locate cudnn_ops...` é”™è¯¯)
   - å°† cuDNN å®‰è£…ç›®å½•ä¸‹çš„ `bin\*.dll` å…¨éƒ¨å¤åˆ¶åˆ° `CUDA\v12.6\bin\`ã€‚
   - å°† `include\*.h` å¤åˆ¶åˆ° `CUDA\v12.6\include\`ã€‚
   - å°† `lib\x64\*.lib` å¤åˆ¶åˆ° `CUDA\v12.6\lib\x64\`ã€‚

### 2.3 è¡¥å……ç¼ºå¤±ä¾èµ– (zlibwapi.dll)
> **æ³¨æ„**: cuDNN ä¾èµ–æ­¤æ–‡ä»¶ï¼Œä½†é»˜è®¤ä¸åŒ…å«ï¼Œ**å¿…é¡»æ‰‹åŠ¨ä¸‹è½½**ã€‚

1. **ä¸‹è½½**: [zlib123dllx64.zip](http://www.winimage.com/zLibDll/zlib123dllx64.zip)
2. **å®‰è£…**:
   - è§£å‹ zipã€‚
   - å°† `zlibwapi.dll` å¤åˆ¶åˆ° `C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.6\bin\`ã€‚

### 2.4 é…ç½® Python ç¯å¢ƒ
1. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**:
   ```powershell
   python -m venv venv
   .\venv\Scripts\Activate.ps1
   python -m pip install --upgrade pip
   ```
2. **å®‰è£… faster-whisper**:
   ```powershell
   pip install faster-whisper
   ```

### 2.5 å®‰è£… Ollama
1. **ä¸‹è½½**: [Ollama for Windows](https://ollama.com/download/windows)
2. **æ‹‰å–æ¨¡å‹** (æ¨è Qwen 3 14B):
   ```powershell
   ollama pull qwen3:14b
   ```

---

## 3. éªŒè¯è„šæœ¬

### 3.1 éªŒè¯ faster-whisper (GPU)
åˆ›å»ºä¸€ä¸ª `test_cuda.py`ï¼š
```python
from faster_whisper import WhisperModel
import time

try:
    print("Loading model to GPU...")
    start = time.time()
    # compute_type="int8" æ˜¯ 4070 Ti Super çš„æœ€ä½³ç”œç‚¹
    model = WhisperModel("tiny", device="cuda", compute_type="int8")
    print(f"âœ… Success! Time: {time.time() - start:.2f}s")
except Exception as e:
    print(f"âŒ Failed: {e}")
```

### 3.2 éªŒè¯ Ollama
```powershell
ollama run qwen3:14b "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ çš„é…ç½®ã€‚"
```

---

## 4. å¸¸è§æŠ¥é”™ä¸ä¿®å¤

### ğŸ”´ æŠ¥é”™: `Could not locate cudnn_ops64_9.dll`
- **åŸå› **: CTranslate2 æ‰¾ä¸åˆ° cuDNN çš„ DLL æ–‡ä»¶ã€‚
- **ä¿®å¤**: ç¡®ä¿å°† cuDNN `bin` ç›®å½•ä¸‹çš„**æ‰€æœ‰** `.dll` æ–‡ä»¶éƒ½å¤åˆ¶åˆ°äº† CUDA `bin` ç›®å½•ã€‚

### ğŸ”´ æŠ¥é”™: `Could not load library cudnn_cnn_infer64_8.dll` (æˆ–ç±»ä¼¼)
- **åŸå› **: ç¼ºå°‘ `zlibwapi.dll`ã€‚
- **ä¿®å¤**: ä¸‹è½½ `zlibwapi.dll` å¹¶æ”¾å…¥ CUDA `bin` ç›®å½•ã€‚

### ğŸ”´ æŠ¥é”™: `RuntimeError: Library cudnn_ops_infer64_8.dll is not found`
- **åŸå› **: ç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆã€‚
- **ä¿®å¤**: é‡å¯ VSCode æˆ– PowerShell ç»ˆç«¯ã€‚

---

## 5. ç¡¬ä»¶æ€§èƒ½å‚è€ƒ (RTX 4070 Ti Super)

- **Whisper Large-v3 (Int8)**:
  - æ˜¾å­˜å ç”¨: ~3GB
  - è½¬å†™é€Ÿåº¦: ~12x å®æ—¶é€Ÿåº¦ (10åˆ†é’ŸéŸ³é¢‘ < 50ç§’)

- **Qwen3-14B (Q4)**:
  - æ˜¾å­˜å ç”¨: ~9GB
  - æ¨ç†é€Ÿåº¦: ~35-45 tokens/s
  - æ€»ç»“è€—æ—¶: ~15-20ç§’ (é’ˆå¯¹ 10åˆ†é’Ÿä¼šè®®å†…å®¹)
  - **ä¼˜åŠ¿**: ç›¸æ¯” 8B æ¨¡å‹ï¼Œé€»è¾‘æ¨ç†å’Œæ€»ç»“è´¨é‡æ˜¾è‘—æå‡

- **ä¸²è¡Œæ‰§è¡Œæ¨¡å¼**: 16GB æ˜¾å­˜é‡‡ç”¨ä¸²è¡Œæ‰§è¡Œï¼ˆå…ˆ Whisper è½¬å†™ï¼Œå† Ollama æ€»ç»“ï¼‰ï¼Œå¯å®Œç¾è¿è¡Œ Whisper Large-v3 + Qwen3-14Bï¼Œæ— éœ€æ‹…å¿ƒæ˜¾å­˜ä¸è¶³ã€‚

