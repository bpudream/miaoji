# 网络访问问题排查指南

## 问题：手机可以 ping 通服务器，但无法访问前端页面

### 可能原因及解决方案

### 1. Windows 防火墙阻止了端口 5173（最常见）

**解决方法：在 Windows 防火墙中开放端口**

#### 方法 A：通过图形界面（推荐）

1. 打开 **Windows 安全中心** → **防火墙和网络保护**
2. 点击 **高级设置**
3. 在左侧选择 **入站规则** → 点击右侧 **新建规则**
4. 选择 **端口** → 下一步
5. 选择 **TCP**，输入端口号 **5173** → 下一步
6. 选择 **允许连接** → 下一步
7. 勾选所有配置文件（域、专用、公用）→ 下一步
8. 输入规则名称：`Vite Dev Server (5173)` → 完成

#### 方法 B：通过 PowerShell（管理员权限）

```powershell
# 允许端口 5173 的入站连接
New-NetFirewallRule -DisplayName "Vite Dev Server" -Direction Inbound -LocalPort 5173 -Protocol TCP -Action Allow
```

### 2. 确认 Vite 服务器正确启动

重启前端服务后，检查终端输出是否包含：

```
➜  Network: http://192.168.101.30:5173/
```

如果没有看到 `Network:` 这一行，说明服务器可能没有监听局域网。

### 3. 检查网络接口

确保手机和电脑在**同一个子网**：
- 电脑 IP：`192.168.101.30`
- 手机 IP：应该是 `192.168.101.x`（同一网段）

### 4. 临时测试：关闭防火墙（仅用于诊断）

⚠️ **仅用于测试，确认问题后请重新开启防火墙**

```powershell
# 临时关闭防火墙（管理员权限）
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False

# 测试完成后重新开启
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
```

### 5. 检查路由器/网络策略

某些企业网络或路由器可能阻止了非标准端口。可以尝试：
- 使用标准端口（如 80 或 8080）进行测试
- 检查路由器是否开启了 AP 隔离

### 6. 验证步骤

1. **在电脑上测试**：浏览器访问 `http://192.168.101.30:5173`（应该能打开）
2. **在手机上测试**：浏览器访问 `http://192.168.101.30:5173`
3. **检查端口监听**：在 PowerShell 运行 `netstat -an | findstr 5173`，应该看到 `0.0.0.0:5173`

### 快速诊断命令

```powershell
# 检查端口是否被监听
netstat -an | findstr 5173

# 检查防火墙规则
Get-NetFirewallRule | Where-Object {$_.DisplayName -like "*5173*"}

# 测试端口是否可达（在手机上或另一台电脑上）
telnet 192.168.101.30 5173
```

